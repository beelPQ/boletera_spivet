(()=>{let e=async(e,t,r)=>{let n=[];n="GET"==t?{method:"GET"}:{method:"POST",body:r};let o=await fetch(e,n);return await o.json()},t=(e,t,r,n)=>{Swal.fire({icon:`${e}`,title:`${t}`,html:`${r}`,confirmButtonText:`${n}`})},r=e=>{if(e){let t=document.querySelectorAll(".anim-skeleton");t.forEach(e=>{e.classList.add("skeleton")})}else setTimeout(()=>{let e=document.querySelectorAll(".anim-skeleton");e.forEach(e=>{e.classList.remove("skeleton")})},200)},n=()=>{let r=document.querySelector("#curso").value||"",n=new FormData;n.append("idCourse",r),n.append("method","getDocumentIfExist"),e("/admin/includes/modelo/design_credencial/designCredencialModel.php","POST",n).then(e=>{if(e.status){if(e.information){if(sessionStorage.setItem("previousDesign",JSON.stringify(e.information)),"-"!=e.information[0].structure){sessionStorage.setItem("designPreviewFinishedCred","true"),a(e.information);let t=document.querySelector(".content-sections");t.style.display="flex"}else{sessionStorage.setItem("designPreviewFinishedCred","false"),document.querySelector(".content-desig-gen");let r=document.querySelector(".content-controls"),n=document.createElement("div");n.id="alertNewDesign",n.classList.add("alert","alert-success","mt-5"),n.style.display="flex",n.style.flexDirection="column",n.innerHTML=`<h4 class="alert-heading">\xa1Bienvenido al dise\xf1ador de credencial/gafete!</h4>
                                  <p>Para poder iniciar es necesario presionar el bot\xf3n <strong>"Iniciar configuraci\xf3n"</strong> que se encuentra en la parte inferior de opciones</p>
                                  `,r.insertAdjacentElement("beforebegin",n);let o=document.querySelector(".content-sections");o.style.display="none",i("active")}setTimeout(()=>{let e=document.querySelectorAll(".anim-skeleton");e.forEach(e=>{e.classList.remove("skeleton")})},2e3)}else{sessionStorage.setItem("previousDesign","[]"),sessionStorage.setItem("designPreviewFinishedCred","false"),document.querySelector(".content-desig-gen");let l=document.querySelector(".content-controls"),c=document.createElement("div");c.id="alertNewDesign",c.classList.add("alert","alert-success","mt-5"),c.style.display="flex",c.style.flexDirection="column",c.innerHTML=`<h4 class="alert-heading">\xa1Bienvenido al dise\xf1ador de credencial/gafete!</h4>
                             <p>Para poder iniciar es necesario presionar el bot\xf3n <strong>"Iniciar configuraci\xf3n"</strong> que se encuentra en la parte inferior de opciones</p>
                            `,l.insertAdjacentElement("beforebegin",c);let s=document.querySelector(".content-sections");s.style.display="none",i("desactive"),setTimeout(()=>{let e=document.querySelectorAll(".anim-skeleton");e.forEach(e=>{e.classList.remove("skeleton")})},2e3)}}}).catch(e=>{t("error","Error",e,"Entendido")})},o=e=>{e.click(),e.checked=!0,e.disabled=!0},l=()=>{let r=document.querySelector("#curso").value||"",n=new FormData;n.append("method","getOwner"),n.append("idCourse",r),e("/admin/includes/modelo/design_credencial/designCredencialModel.php","POST",n).then(e=>{if(e.status){sessionStorage.setItem("dataOwner",JSON.stringify(e.data));let t=document.querySelector(".bg-footer"),r=e.data[0],n=document.createElement("span");n.innerText="Comunicaci\xf3n",n.classList.add("text-bold");let o=document.createElement("span");o.innerText=r.email;let l=document.createElement("span");l.innerText=r.phone;let i=document.createElement("span");i.innerText=r.domain,document.createElement("br");let a=document.createElement("br"),c=document.createElement("br"),s=document.createElement("br");t.appendChild(n),t.appendChild(a),t.appendChild(o),t.appendChild(c),t.appendChild(l),t.appendChild(s),t.appendChild(i)}}).catch(e=>{t("error","Error",e,"Entendido")})},i=(e="disabled")=>{"active"==e?(document.querySelector("#btnPrint").disabled=!1,document.querySelector("#btnSaveStructureDocto").disabled=!1,document.querySelector("#btnCancelDesign").disabled=!1):(document.querySelector("#btnPrint").disabled=!0,document.querySelector("#btnSaveStructureDocto").disabled=!0,document.querySelector("#btnCancelDesign").disabled=!0)},a=e=>{let t=e[0],r=document.querySelector("#contentGeneral");"portrait"==t.orientation&&r.classList.add("gen-portrait");let n=JSON.parse(t.structure),o=t.domain||"",l=t.logo||"",i=new Date;"noImage"!=n.previewImage1?(console.log(`${o}/admin/images/design_credencial/${n.previewImage1}?v=${i.getTime()}`),document.querySelector("#imgLogoSelected").src=`${o}/admin/images/design_credencial/${n.previewImage1}?v=${i.getTime()}`,document.querySelector("#previewImage1").src=`${t.logoBase64}`,document.querySelector("#previewImage1_delete").style.display="flex"):document.querySelector("#imgLogoSelected").src=`${o}/images/${l}`,"noImage"!=n.previewImage2?(document.querySelector("#imgBgSelectedSec2").src=`${o}/admin/images/design_credencial/${n.previewImage2}?v=${i.getTime()}`,document.querySelector("#previewImage2").src=`${t.logoBase64bgSec2}`,document.querySelector("#previewImage2_delete").style.display="flex"):document.querySelector("#imgBgSelectedSec2").src="",""!=n.colorBgTop&&(document.querySelector("#colorTopDesing").value=n.colorBgTop,document.querySelector("#bgTop").style.background=n.colorBgTop),n.toggleAccess&&(document.querySelector("#togAccess").checked=n.toggleAccess,document.querySelector("#togAccess").click()),n.toggleMyData&&document.querySelector("#togMyData").click(),n.toggleAgenda&&document.querySelector("#togAgenda").click();let a=document.querySelector(".content-sections-mockup"),c=document.createElement("button");c.id="btnDeleteDesignCredencial",c.classList.add("btn","btn-delete-design","anim-skeleton","skeleton"),a.appendChild(c),setTimeout(()=>{let e=document.querySelectorAll(".anim-skeleton");e.forEach(e=>{e.classList.remove("skeleton")})},2e3),document.querySelectorAll(".control-dinamyc"),"0"==t.statusTagOnly?document.querySelector("#allDesign").click():document.querySelector("#tagOnly").click()},c=()=>{let t=document.querySelector("#tagOnly"),n="",o="";if(t.checked){let l=document.querySelector("#imgLogoSelected");n=l.src,l.src="";let i=document.querySelector("#imgBgSelectedSec2");o=i.src,i.src=""}document.querySelectorAll(".anim-skeleton"),r(!0);let a=document.querySelector("#curso").value||"",c=document.getElementById("contentGeneral"),s=c.innerHTML.replace(/&quot;/g,""),d="portrait",g=new FormData;g.append("structure",s),g.append("idCourse",a),g.append("orientation",d),g.append("method","previewDesignDocument"),e("/admin/includes/modelo/design_credencial/designCredencialModel.php","POST",g).then(e=>{if(e.status){if(window.open(`/admin/files/mockups/credencial/${e.nameDocto}`,"_blank"),r(!1),""!=n){let t=document.querySelector("#imgLogoSelected");t.src=n;let l=document.querySelector("#imgBgSelectedSec2");l.src=o}}else if(r(!1),""!=n){let i=document.querySelector("#imgLogoSelected");i.src=n;let a=document.querySelector("#imgBgSelectedSec2");a.src=o}}).catch(e=>{r(!1)})},s=()=>{r(!0);let n=document.querySelector("#curso").value||"",o=document.getElementById("contentGeneral");o.innerHTML.replace(/&quot;/g,"");let l=document.querySelector("#controlsPageTab1"),i=l.querySelector("#previewImage1").src||"",a=l.querySelector("#colorTopDesing").value||"",c=l.querySelector("#togAccess").checked||!1,s=l.querySelector("#togMyData").checked||!1,d=l.querySelector("#togAgenda").checked||!1,g=document.querySelector("#controlsPageTab2");previewImage2=g.querySelector("#previewImage2").src||"";let u=document.querySelector("#tagOnly").checked||!1,m={};m.previewImage1=i,m.colorBgTop=a,m.toggleAccess=c,m.toggleMyData=s,m.toggleAgenda=d,m.previewImage2=previewImage2,m.tagOnlyStatus=u;let p=new FormData;p.append("idCourse",n),p.append("orientation","portrait"),p.append("controlsSect",JSON.stringify(m)),p.append("method","saveDesignDocument"),e("/admin/includes/modelo/design_credencial/designCredencialModel.php","POST",p).then(e=>{e.status?(r(!1),t("success",`Dise\xf1o almacenado`,`El dise\xf1o ha sido <strong> almacenado </strong> exitosamente`,"Entendido")):(r(!1),t("warning","Ha ocurrido un error",e.message,"Entendido"))}).catch(e=>{console.error(e)})},d=(r,n)=>{let o=document.querySelector("#event").value||"";document.getElementById("contentGeneral").innerHTML;let l=new FormData;l.append("idEvent",o),l.append("imagen",n),l.append("orientation",r),l.append("method","saveOrientationBackground"),e("/admin/includes/modelo/designDiploma/designDiplomaModel.php","POST",l).then(e=>{if(e.status){document.querySelector("#btnCloseModalConfig").click();let r=document.querySelector("#contentDiploma"),n=new Date().getTime();r.style.backgroundImage=`url('/admin/images/design_diploma/${e.nameImage}?v=${n}')`;let o=document.querySelector(".content-desig-gen"),l=document.querySelector("#alertNewDesign");o.removeChild(l),document.querySelector(".content-sections").style.display="flex",i("active")}else t("error",e.title,e.message,"Entendido")}).catch(e=>{console.error(e)})},g=e=>{let t=document.querySelector("#contentDiploma"),r=document.querySelector("#contentGeneral");"landscape"==e?(t.classList.add("orien-landscape"),t.classList.remove("orien-portrait"),r.classList.add("gen-landscape"),r.classList.remove("gen-portrait")):"portrait"==e&&(t.classList.add("orien-portrait"),t.classList.remove("orien-landscape"),r.classList.add("gen-portrait"),r.classList.remove("gen-landscape"))},u=e=>{let t=document.querySelector(`#con${e}`),r=document.createElement("div");if(r.classList.add("element-tag","tag-disabled"),r.id=e,"tagtogNameUser"==e)r.classList.add("tag-name"),r.innerText="Nombre completo del participante";else if("tagtogCredits"==e){let n=document.createElement("input");n.classList.add("form-control-custom"),n.type="text",n.id="credits",n.setAttribute("value",""),n.setAttribute("maxlength","48"),r.classList.add("tag-credit"),r.appendChild(n)}t.appendChild(r)},m=(e,t)=>{let r=document.querySelector("#event").value||"",n={};n.course=r,"orientationPortrait"==e&&(n.orientation="portrait"),"orientationLandscape"==e&&(n.orientation="landscape"),sessionStorage.setItem("configOrientation",JSON.stringify(n)),g(n.orientation),d(n.orientation,t.files[0])},p=()=>{r(!0);let n=document.querySelector("#curso").value||"",o=new FormData;o.append("idCourse",n),o.append("method","deleteDesign"),e("/admin/includes/modelo/design_credencial/designCredencialModel.php","POST",o).then(e=>{e.status?(r(!1),Swal.fire({title:"Dise\xf1o eliminado",html:`El dise\xf1o ha sido <strong> eliminado </strong> exitosamente`,icon:"success",confirmButtonText:"Entendido"}).then(e=>{e.isConfirmed&&window.location.reload()})):(r(!1),t("error","Error",e.message,"Entendido"))}).catch(e=>{r(!1),console.error(e)})},y=e=>{let t=e.split("btn")[1],r=document.getElementById(e),n=document.getElementById(`controls${t}`),o=document.querySelectorAll(".content-sections-elements");o.forEach(e=>{e.classList.remove("active"),e.classList.add("desactive")}),n.classList.add("active"),n.classList.remove("desactive");let l=document.querySelectorAll(".btn-pagetab");l.forEach(e=>{e.classList.remove("pagetab-selected")}),r.classList.add("pagetab-selected")},S=()=>{let e=document.querySelectorAll(".custom-control-input"),t=document.querySelector(".bg-center");t.innerHTML="";let r=0,n="";n='<div class="cont-2-qr">',e.forEach(e=>{e.checked&&(r++,n+=` 
                    <div class="qr-code1">
                        <span>${e.dataset.title}</span><br>
                        <img src="https://upload.wikimedia.org/wikipedia/commons/d/d0/QR_code_for_mobile_English_Wikipedia.svg" alt="">
                    </div> 
                `)}),n+="</div>",t.innerHTML=n},q=e=>{if("show"==e){document.querySelector("#imgLogoSelected").style.display="block",document.querySelector(".bg-center").style.display="block",document.querySelector(".bg-footer").style.display="block";let t=document.querySelector("#colorTopDesing").value||"#000";document.querySelector(".bg-top").style.background=t,document.querySelector("#imgBgSelectedSec2").style.display="block",document.querySelector("#btnPageTab2").disabled=!1,document.querySelector("#btnPageTab2").style.opacity=1;let r=document.querySelectorAll(".control-dinamyc");r.forEach(e=>{e.style.display="block"})}else if("hide"==e){document.querySelector("#imgLogoSelected").style.display="none",document.querySelector(".bg-center").style.display="none",document.querySelector(".bg-footer").style.display="none",document.querySelector(".bg-top").style.background="#fff",document.querySelector("#imgBgSelectedSec2").style.display="none",document.querySelector("#btnPageTab2").disabled=!0,document.querySelector("#btnPageTab2").style.opacity=0;let n=document.querySelectorAll(".control-dinamyc");n.forEach(e=>{e.style.display="none"})}},h=document.querySelector("#btnPrint");h.addEventListener("click",c),window.addEventListener("click",e=>{let r=e.target.id;if(("btnPageTab1"==r||"btnPageTab2"==r)&&y(r),"addBackgDocument"==r){let n=document.querySelector(`#${r}`),o=document.querySelector("#imageDocto");o.click(),o.addEventListener("change",function(e){let t=e.target.files[0];t&&(console.log(t),n.innerText=t.name)})}if("btnSaveOrientationBack"==r){let l=document.querySelector("#desicionOrientation"),a=l.querySelector(".btn-selected"),c=document.querySelector("#imageDocto");a?c.files.length>0?m(a.id,c):t("warning",`Informaci\xf3n incompleta`,`Favor de proporcionar una <strong> imagen de fondo </strong> para el dise\xf1o`,"Entendido"):t("warning",`Informaci\xf3n incompleta`,`Favor de seleccionar una <strong> orientaci\xf3n </strong> para el dise\xf1o`,"Entendido")}if("btnSaveStructureDocto"==r){let d=document.querySelector("#previewImage1"),g=document.querySelector("#tagOnly");g.checked?Swal.fire({title:"Guardar",text:"\xbfSeguro que deseas guardar el dise\xf1o previamente hecho?",icon:"question",showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonText:"Si guardar"}).then(e=>{e.isConfirmed&&s()}):d.src.includes("data:image/png;base64,")?Swal.fire({title:"Guardar",text:"\xbfSeguro que deseas guardar el dise\xf1o previamente hecho?",icon:"question",showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonText:"Si guardar"}).then(e=>{e.isConfirmed&&s()}):t("warning",`Informaci\xf3n incompleta`,`Favor de seleccionar un <strong>logo principal </strong> para el dise\xf1o`,"Entendido")}if("openConfigDocument"==r){if(document.querySelector(".content-sections").style.display="flex",document.querySelector("#alertNewDesign").style.display="none",document.querySelector("#allDesign").click(),i("active"),sessionStorage.getItem("designPreviewFinishedCred")&&"false"==sessionStorage.getItem("designPreviewFinishedCred")){if(sessionStorage.getItem("dataOwner")){let u=JSON.parse(sessionStorage.getItem("dataOwner"));document.querySelector("#imgLogoSelected").src=`${u[0].domain}/images/${u[0].logo}`}}else sessionStorage.getItem("designPreviewFinishedCred")&&sessionStorage.getItem("designPreviewFinishedCred")}if("btnCancelDesign"==r&&(sessionStorage.getItem("designPreviewFinishedCred")&&"true"==sessionStorage.getItem("designPreviewFinishedCred")?Swal.fire({title:"Cancelar",html:`<strong>\xbfSeguro que deseas cancelar?</strong></br></br>Todos los cambios no guardados despu\xe9s del \xfaltimo guardado se perder\xe1n`,icon:"question",showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonText:"Si cancelar",cancelButtonText:"No cancelar"}).then(e=>{e.isConfirmed&&(window.location.href="/admin/index.php?id=lista-cursos-design")}):Swal.fire({title:"Cancelar",html:`<strong>\xbfSeguro que deseas cancelar?</strong></br></br>Todos los cambios no guardados se perder\xe1n`,icon:"question",showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonText:"Si cancelar",cancelButtonText:"No cancelar"}).then(e=>{e.isConfirmed&&(window.location.href="/admin/index.php?id=lista-cursos-design")})),"btnDeleteDesignCredencial"==r&&Swal.fire({title:"Eliminar",html:`<strong>\xbfSeguro que deseas eliminar el dise\xf1o guardado?</strong></br></br>Todos los cambios se perder\xe1n`,icon:"question",showCancelButton:!0,cancelButtonColor:"#d33",confirmButtonText:"Si eliminar",cancelButtonText:"cancelar"}).then(e=>{e.isConfirmed&&p()}),"allDesign"==r){let S=document.getElementById(r);S.checked&&q("show")}if("tagOnly"==r){let h=document.getElementById(r);h.checked&&q("hide")}}),window.addEventListener("dragstart",e=>{let t=e.target.id;("tagtogNameUser"==t||"tagtogCredits"==t)&&e.dataTransfer.setData("text/plain",t)}),window.addEventListener("change",e=>{let t=e.target.id;if("togNameUser"==t||"togCredits"==t){let r=document.querySelector(`#${t}`),n=document.querySelector(`#tag${t}`);if(r.checked)n.classList.remove("tag-disabled"),n.draggable="true";else{let o=document.querySelector("#contentDiploma");o.contains(n)?(interact(`#tag${t}`).unset(),o.removeChild(n),u(`tag${t}`)):(n.classList.add("tag-disabled"),n.draggable="false")}}if("colorTopDesing"==t){let l=document.getElementById(t),i=document.getElementById("bgTop");i.style.backgroundColor=l.value}("togMyData"==t||"togAccess"==t||"togAgenda"==t)&&S()}),window.addEventListener("DOMContentLoaded",()=>{let e=document.querySelector(".content-columns-control"),t=e.querySelectorAll("input");if(t.forEach(e=>e.checked=!1),n(),document.getElementById("togAccess")){let r=document.getElementById("togAccess");o(r)}l()})})();const asyncDataExterno=async(e,t,r)=>{let n=[];n="GET"==t?{method:"GET"}:{method:"POST",body:r};let o=await fetch(e,n);return await o.json()};