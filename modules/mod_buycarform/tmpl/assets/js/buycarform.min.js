let valuePhone,srcDefaultImg="/modules/mod_buycarform/tmpl/assets/plugin/img/logo_subir_imagen.png";localStorage.setItem("amount",localStorage.getItem("subtotal"));const asyncData2=async(e,t,a)=>{let r=[];r="GET"==t?{method:"GET"}:{method:"POST",body:a};let l=await fetch(e,r);return await l.json()},asycData=async(e,t,a,r)=>{let l="",i={};"POST"==t&&(i={method:"POST",body:r});let o=await fetch(e,i);return"json"==a?await o.json():await o.text()},formatMoney=e=>new Intl.NumberFormat("en-Latn-US",{style:"currency",currency:"USD",maximumFractionDigits:2}).format(e),validateFormFinal=()=>{let e=document.querySelector("#formDataPayment"),t=e.querySelectorAll("input"),a=e.querySelectorAll("select"),r=0,l=0;t.forEach(e=>{"inputConsFiscal"==e.id?(" "!=document.querySelector("#addInvoice_yes").value.trim()&&document.querySelector("#addInvoice_yes").classList.remove("is-invalid")," "!=document.querySelector("#addInvoice_no").value.trim()&&document.querySelector("#addInvoice_no").classList.remove("is-invalid"),document.querySelector("#addInvoice_yes").checked&&(""!=e.value||r++)):"openpay_name"==e.id||"openpay_card"==e.id||"openpay_month"==e.id||"openpay_year"==e.id||"openpay_cvv"==e.id||"token_id"==e.id||"code1_op"==e.id||"code2_op"==e.id||"code3_op"==e.id||"iva"==e.id||"amountIVA"==e.id||"comision"==e.id||"comision_porcentaje"==e.id||"descuento_aplicado"==e.id||"descuento"==e.id||"tipo_descuento"==e.id||"code_descuento"==e.id||"iddescuento"==e.id||"input"==e.id||(""==e.value.trim()||e.classList.contains("is-invalid"))&&r++}),a.forEach(e=>{("no_selected"==e.value||e.classList.contains("is-invalid"))&&l++}),0===r&&0===l?(statusErrorForm=0,document.querySelector("#btnPaymentDesktop").disabled=!1,document.querySelector("#btnPaymentDesktop").classList.remove("btn-disabled")):(statusErrorForm=1,document.querySelector("#btnPaymentDesktop").disabled=!0,document.querySelector("#btnPaymentDesktop").classList.add("btn-disabled"))},getOptionsPayment=()=>{let e=new FormData;e.append("method","paymentMethods"),asyncData2("/modules/mod_buycarform/tmpl/model/buyCarForm.php","POST",e).then(e=>{if(e.status){let t="";t+='<option value="no_selected" disabled selected>Seleccionar</option>',e.data.forEach(e=>{t+=`<option value="${e.id}">${e.namePayment}</option>`}),document.querySelector("#optionsPayment").innerHTML=t}}).catch(e=>{console.error(e)})},eventModalMP=e=>{document.querySelector("#btnModalPayment").click(),initSdkMP(e)};(()=>{let e=0,t=(e=0,t=0)=>{let a=new FormData;0!=e?(a.append("method","getStatesForCountry"),a.append("idCountry",e)):a.append("method","getStates"),asyncData2("/modules/mod_buycarform/tmpl/model/buyCarForm.php","POST",a).then(e=>{if(e.status){let a="";a+='<option value="no_selected" disabled selected>Seleccionar</option>',e.data.forEach(e=>{a+=`<option value="${e.id}" ${t>0&&t==e.id?"selected":""} >${e.state}</option>`}),document.querySelector("#state").innerHTML=a}}).catch(e=>{console.error(e)})},a=()=>{let e=new FormData;e.append("method","getCountries"),asyncData2("/modules/mod_buycarform/tmpl/model/buyCarForm.php","POST",e).then(e=>{if(e.status){let t="";t+='<option value="no_selected" disabled selected>Seleccionar</option>',e.data.forEach(e=>{t+=`<option value="${e.id}">${e.country}</option>`}),document.querySelector("#country").innerHTML=t}}).catch(e=>{console.error(e)})},r=()=>{let e=document.querySelector("#telwhat");valuePhone=window.intlTelInput(e,{preferredCountries:["mx","us"],utilsScript:"/modules/mod_buycarform/tmpl/assets/plugin/js/utils.js"})},l=e=>{let t=document.querySelector("#"+e),a=t.value;if(!RegExp(t.dataset.regularext,"i").exec(a))return t.value="",document.querySelector("#delete_"+e).value="",document.querySelector("#delete_"+e).setAttribute("hidden",""),Swal.fire({title:"Adjunto no aceptable",html:"Solo se permiten archivos con la extencion .<strong>"+t.dataset.extensions+"</strong>",icon:"warning",confirmButtonText:"Cerrar",customClass:{confirmButton:"confirm-btn-alert",denyButton:"deny-btn-alert",cancelButton:"cancel-btn-alert"}}),!1;if(t.files.length>0)for(let r=0;r<=t.files.length-1;r++){let l=t.files.item(r).size,i=Math.round(l/1024),o;if(i>1024*parseFloat(t.dataset.maxsizemb))return t.value="",document.querySelector("#delete_"+e).value="",document.querySelector("#delete_"+e).setAttribute("hidden",""),Swal.fire({title:"Cuidado",html:"El tama\xf1o m\xe1ximo admitido es de "+t.dataset.maxsizemb+"MB",icon:"warning",confirmButtonText:"Cerrar",customClass:{confirmButton:"confirm-btn-alert",denyButton:"deny-btn-alert",cancelButton:"cancel-btn-alert"}}),!1;document.querySelector("#delete_"+e).innerHTML=t.value.split("\\").pop()+'<img data-idfile="'+e+'" class="btnCleanFile" src="/modules/mod_buycarform/tmpl/assets/img/icons/icon_delete_file.svg">',document.querySelector("#delete_"+e).removeAttribute("hidden"),validateFormFinal()}},i=e=>{pricemxn=parseFloat(e.dataset.pricemxn),priceusd=parseFloat(e.dataset.priceusd);let t;t="USD"==localStorage.getItem("moneda")?priceusd:pricemxn;let a=parseFloat(localStorage.getItem("subtotal"));a-=t,localStorage.setItem("subtotal",a);document.querySelectorAll(".label-subtotal").forEach(function(e){e.innerHTML=formatMoney(a)});document.querySelectorAll(".deleteProduct").forEach(function(t){t.dataset.code==e.dataset.code&&t.parentElement.parentElement.remove()});document.querySelectorAll(".btnAdd").forEach(function(t){t.dataset.code==e.dataset.code&&(t.innerHTML="Agregar al carrito",t.removeAttribute("disabled"),t.style.opacity="unset")});document.querySelectorAll(".counterItems").forEach(function(e){let t=parseInt(e.innerHTML);t-=1,e.innerHTML=t});let r=JSON.parse(localStorage.getItem("cart_products")),l=0;if(r.every(function(t){return t.code!=e.dataset.code&&(l++,!0)}),r.splice(l,1),localStorage.setItem("cart_products",JSON.stringify(r)),localStorage.getItem("cart_products")&&JSON.parse(localStorage.getItem("cart_products")).length<=0&&(location.href=null!==localStorage.getItem("inhost")&&"server"==localStorage.getItem("inhost")?`${window.location.origin}/servicios`:`${window.location.origin}/index.php?option=com_blank&view=blank&Itemid=110`),localStorage.getItem("subtotal")&&0>=parseFloat(localStorage.getItem("subtotal"))&&""!=document.querySelector("#descuento_aplicado").value){document.querySelectorAll(".input-cupon").forEach(function(e){e.removeAttribute("disabled"),e.value=""});document.querySelectorAll(".btn-cupon-dis").forEach(function(e){e.removeAttribute("disabled"),e.setAttribute("class","btn-cupon"),e.innerHTML="Aplicar"}),document.querySelector("#descuento_aplicado").value="",document.querySelector("#descuento").value=0,document.querySelector("#tipo_descuento").value="",document.querySelector("#code_descuento").value="",document.querySelector("#iddescuento").value="";document.querySelectorAll(".label-discount").forEach(function(e){e.innerHTML="$0.00"})}verifyFormPayIsRequired(),setTimeout(()=>{""!=document.querySelector("#descuento_aplicado").value?calculate_cupon():calculate_total()},200)},o=()=>{if(localStorage.getItem("cart_products")&&JSON.parse(localStorage.getItem("cart_products")).length>0){let e=new FormData;e.append("select",""),e.append("input",""),e.append("method","getProducts"),e.append("limit",3),e.append("code",1),asycData("/modules/mod_buycar/tmpl/controllers/queries.php","POST","json",e).then(e=>{if(200==e.status_code){let t=e.productsAll,a="";localStorage.getItem("cart_products")&&JSON.parse(localStorage.getItem("cart_products")).length>0&&(a=JSON.parse(localStorage.getItem("cart_products")));let r=0;t.forEach(function(e){if(localStorage.getItem("cart_products")&&JSON.parse(localStorage.getItem("cart_products")).length>0){let t=0,l=0;a.every(a=>{if(a.code!=e.code)return t++,!0;if(e.catalogo_productos_stock>0&&1==e.catalogo_productos_publicado&&Date.parse(e.catalogo_productos_fechainicio)>=Date.parse(e.currentDate)){let i=0;if("Virtual"==a.modality?(2==e.producto_modalidad_idsystemprodmod||3==e.producto_modalidad_idsystemprodmod)&&(i=1):"Presencial"==a.modality&&(1==e.producto_modalidad_idsystemprodmod||3==e.producto_modalidad_idsystemprodmod)&&(i=1),1==i){a.name=e.catalogo_productos_nombre;let o=e.pricemxn;parseFloat(e.pricemxn_discount)>0&&(o=e.pricemxn_discount),o=parseFloat(o=o.replace(/,/gi,"")),a.pricemxn=o.toFixed(2),a.priceusd=0,r+=o}else l=1}else l=1;return!1}),1==l&&a.splice(t,1),localStorage.setItem("cart_products",JSON.stringify(a))}}),localStorage.setItem("subtotal",r),localStorage.setItem("amount",r)}else Swal.fire({title:"Error encontrado!",text:"Ocurrio un error al consultar los datos del carrito",icon:"error",confirmButtonText:"Cerrar",customClass:{confirmButton:"confirm-btn-alert"}}).then(e=>{location.href=null!==localStorage.getItem("inhost")&&"server"==localStorage.getItem("inhost")?`${window.location.origin}/servicios`:`${window.location.origin}/index.php?option=com_blank&view=blank&Itemid=110`})}).catch(e=>{Swal.fire({title:"Error encontrado!",text:e,icon:"error",confirmButtonText:"Cerrar",customClass:{confirmButton:"confirm-btn-alert"}}).then(e=>{location.href=null!==localStorage.getItem("inhost")&&"server"==localStorage.getItem("inhost")?`${window.location.origin}/servicios`:`${window.location.origin}/index.php?option=com_blank&view=blank&Itemid=110`})})}},n=()=>{if(localStorage.getItem("cart_products")){let e="",t=localStorage.getItem("cart_products"),a=JSON.parse(t),r="Product",l=formatMoney(localStorage.getItem("amount")),i=formatMoney(localStorage.getItem("subtotal"));a.forEach(t=>{e+=`
                <div class="rowItemPayment ${r}">
                    <div class="itemPayment_name">
                        <span class="concept_pay">${t.name}</span><br>
                        <span class="delete${r}" data-code="${t.code}" data-pricemxn="${t.pricemxn}" data-priceusd="${t.priceusd}" >Eliminar</span>
                    </div>
                    <div class="itemPayment_price">
                        <span class="label-currency">MXN</span> 
                        <span class="label-price" data-pricemxn="${formatMoney(t.pricemxn)}" data-priceusd="${formatMoney(t.priceusd)}" >${formatMoney(t.pricemxn)}</span>
                    </div>
                </div>
                `}),document.querySelector(".label-total").innerText=`${l}`,document.querySelector(".contentItemsPayment").innerHTML=e,document.querySelector(".label-subtotal").innerText=i,document.querySelector(".label-total").innerText=l;let o=document.querySelectorAll(".counterItems");o.forEach(e=>{e.innerText=a.length});let n=document.querySelectorAll(".label-total");n.forEach(e=>{e.innerText=l}),setTimeout(()=>{document.querySelector(".clickDeploySumPayDesktop").click()},2e3),calculate_total()}},s=e=>{"Ver"==document.querySelector("#label-deploySumPay"+e).innerHTML?document.querySelector("#label-deploySumPay"+e).innerHTML="Cerrar":document.querySelector("#label-deploySumPay"+e).innerHTML="Ver"},c=e=>{let t=e.parentElement,a=`${e.id}Error`;if(t.querySelector(`#${a}`)){e.classList.remove("is-invalid");let r=t.querySelector(`#${a}`);t.removeChild(r)}},d=(e,t)=>{let a=e.parentElement,r=`${e.id}Error`;if(a.querySelector(`#${r}`)){e.classList.remove("is-invalid");let l=a.querySelector(`#${r}`);a.removeChild(l)}e.classList.add("is-invalid");let i=document.createElement("span");i.id=r,i.classList.add("msg_error"),i.innerHTML=t,a.appendChild(i)},u=e=>{let t=0;e.classList.remove("is-invalid");let a=/^[-\w.%+]{1,64}@(?:[A-Z0-9-]{1,63}\.){1,125}[A-Z]{2,63}$/i,r=[{input:"name",valMin:2,messageLengt:"Numero de caracteres mayor a 2",messageVacio:"Nombre requerido"},{input:"lastname1",valMin:2,valMax:30,messageLengt:"Numero de caracteres mayor a 4",messageVacio:"Apellido requerido"},{input:"lastname2",valMin:2,valMax:30,messageLengt:"Numero de caracteres mayor a 4",messageVacio:"Apellido requerido"},{input:"email",valMin:4,valMax:30,messageLengt:"Correo no valido",messageVacio:"Correo requerido"},{input:"telwhat",valMin:9,valMax:12,messageLengt:"Numero no valido",messageVacio:"Telefono requerido"},{input:"cp",valMin:4,valMax:30,messageLengt:"Codigo postal no valido",messageVacio:"Codigo postal requerido"}];return r.forEach(r=>{e.id==r.input&&("email"===e.id?a.test(e.value)?c(e):(d(e,r.messageLengt),t+=1):""!=e.value.trim()?e.value.length>r.valMin?c(e):(d(e,r.messageLengt),t+=1):(d(e,r.messageVacio),t+=1))}),t},m=t=>{let a=[{select:"country",messageVacio:"Pais requerido"},{select:"towns",messageVacio:"Municipio requerido"},{select:"optionsPayment",messageVacio:"Metodo de pago requerido"}];a.forEach(a=>{t.id==a.select&&("no_selected"!==t.value.trim()?c(t):(d(t,a.messageVacio),e++))})},p=e=>{let t=e.charCode;return t>=48&&t<=57},y=e=>{proccessPago(e)};window.addEventListener("click",e=>{if(e.target){let t=e.target,a=e.target.id,r=e.target.classList;if(r.contains("deleteProduct"))i(t);else if(r.contains("clickDeploySumPayDesktop"))s("Desktop");else if(r.contains("btnCleanFile"))document.querySelector("#"+t.dataset.idfile).value="",document.querySelector("#delete_"+t.dataset.idfile).value="",document.querySelector("#delete_"+t.dataset.idfile).setAttribute("hidden",""),validateFormFinal();else if(r.contains("payment-button")){let l=document.querySelector("img#avatar")||null;if(!l.src.includes("data:image")&&!l.src.includes("/images/clientes/fotos")){Swal.fire({icon:"warning",title:"Foto de usuario",html:"Agregue una foto para continuar",confirmButtonText:"Cerrar",customClass:{confirmButton:"confirm-btn-alert",denyButton:"deny-btn-alert",cancelButton:"cancel-btn-alert"}});return}let o=document.querySelector("#checkAviso");o.checked?y("Desktop"):Swal.fire({icon:"warning",title:"Aviso de Privacidad",html:"Para continuar es necesario <strong> aceptar el Aviso de Privacidad </strong>",confirmButtonText:"Cerrar",customClass:{confirmButton:"confirm-btn-alert",denyButton:"deny-btn-alert",cancelButton:"cancel-btn-alert"}})}else r.contains("btn-cupon")&&(document.querySelector(".spinner").style.display="flex",apply_cupon());"btnExit"==a&&(location.href="/"),"btnClosedModal"==a&&location.reload()}});let b=()=>{localStorage.getItem("cart_products")&&JSON.parse(localStorage.getItem("cart_products")).length>0?(r(),o(),setTimeout(function(){n()},200),a(),validateFormFinal(),setTimeout(function(){verifyFormPayIsRequired("load")},200),setTimeout(()=>{document.querySelector(".spinner")&&(document.querySelector(".spinner").style.display="none")},800)):location.href=null!==localStorage.getItem("inhost")&&"server"==localStorage.getItem("inhost")?`${window.location.origin}/servicios`:`${window.location.origin}/index.php?option=com_blank&view=blank&Itemid=110`},v=(e,t=50)=>{let a=0,r=setInterval(function(){a>=1?(clearInterval(r),e.style.display="block"):(a+=.1,e.style.opacity=a)},t)},g=(e,t=50)=>{let a=1,r=setInterval(function(){a<=.1?(clearInterval(r),e.style.display="none"):(a-=.1,e.style.opacity=a)},t)},f=(e,t,a=!1)=>{if(a){e.name.setAttribute("readonly",!0),e.name.classList.add("btn-disabled"),e.lastname1.setAttribute("readonly",!0),e.lastname1.classList.add("btn-disabled"),e.lastname2.setAttribute("readonly",!0),e.lastname2.classList.add("btn-disabled"),e.email.setAttribute("readonly",!0),e.email.classList.add("btn-disabled"),e.telwhat.setAttribute("readonly",!0),e.telwhat.classList.add("btn-disabled"),e.cp.setAttribute("readonly",!0),e.cp.classList.add("btn-disabled"),e.country.setAttribute("disabled",!0),e.country.classList.add("btn-disabled"),e.state.setAttribute("disabled",!0),e.state.classList.add("btn-disabled");let r=formDataPayment.querySelector("#tmpAvatarServices");r.removeAttribute("style"),t.setAttribute("style","display:none;"),t.src.includes("data:image/")?r.src=t.src:t.src=r.src;let l=formDataPayment.querySelector(".content_preview_image"),i=l.querySelector("#btnDeleteImg");l.setAttribute("style","display:none;"),i.setAttribute("style","display:none;")}else{e.name.removeAttribute("readonly"),e.name.classList.remove("btn-disabled"),e.lastname1.removeAttribute("readonly"),e.lastname1.classList.remove("btn-disabled"),e.lastname2.removeAttribute("readonly"),e.lastname2.classList.remove("btn-disabled"),e.email.removeAttribute("readonly"),e.email.classList.remove("btn-disabled"),e.telwhat.removeAttribute("readonly"),e.telwhat.classList.remove("btn-disabled"),e.cp.removeAttribute("readonly"),e.cp.classList.remove("btn-disabled"),e.country.removeAttribute("disabled"),e.country.classList.remove("btn-disabled"),e.state.removeAttribute("disabled"),e.state.classList.remove("btn-disabled");let o=formDataPayment.querySelector("#tmpAvatarServices");o.setAttribute("style","display:none;");let n=formDataPayment.querySelector(".content_preview_image"),s=n.querySelector("#btnDeleteImg");n.removeAttribute("style"),s.removeAttribute("style"),t.removeAttribute("style")}},h=(e,t,a)=>{let r=0,l=new FormData;l.append("method","updateProfile"),l.append("userid",localStorage.getItem("userid")||""),l.append("tmiduser",document.body.getAttribute("data-id")||0),l.append("tmemailuser",document.body.getAttribute("data-email")||"");let i={},o="",n="",s="",c="";t.forEach(e=>{let t=e.id,a=e.value;if(e.classList.remove("is-invalid"),""!=a.trim()&&"input"!=t&&"addInvoice_no"!=t&&"addInvoice_yes"!=t&&"amountIVA"!=t&&"code1_op"!=t&&"code2_op"!=t&&"code3_op"!=t&&"comision"!=t&&"comision_porcentaje"!=t&&"descuento"!=t&&"iva"!=t){if("name"==t&&(o=a.trim()),"lastname1"==t&&(n=a.trim()),"lastname2"==t&&(s=a.trim()),"email"==t&&(c=a.trim()),"telwhat"==t){let r=e.closest(".iti"),d=r.querySelector(".iti__selected-flag")||null;if(null!==d){let u=d.getAttribute("title").split(":")[1].trim();l.append("lada",`${u.replaceAll(" ","")}`)}else l.append("lada","+52");l.append("phoneNumber",`${a.replaceAll(" ","")}`)}else"cp"==t?l.append("postlaCode",a):l.append(`${t}`,a);i[`${t}`]=e}else e.classList.add("is-invalid")}),a.forEach(e=>{let t=e.id,a=e.value;e.classList.remove("is-invalid"),"optionsPayment"!=t&&("no_selected"!=a.trim()?l.append(`${t}`,parseInt(a)):e.classList.add("is-invalid"),i[`${t}`]=e)});let d=formDataPayment.querySelector("img#avatar")||null;if(d.classList.remove("invalid"),d.src.includes(srcDefaultImg)?(d.classList.add("invalid"),r+=1):l.append(`${d.id}`,d.src),r>0)return;f(i,d,!0);let u=e.querySelector("#editDataService"),m=e.querySelector("#cancelDataService");m.setAttribute("style","display:none;");let p=e.querySelector("#saveDataService");p.innerHTML='<i class="fas fa-circle-notch fa-pulse"></i>';try{asyncData2("/modules/mod_my_profile/tmpl/controllers/mdlMyProfile.php","POST",l).then(e=>{let{result:a,message:r,id_client:l}=e,y=""!=r.trim()?r:"Datos actualizados correctamenete";""!=l.trim()&&parseInt(l)>0?(document.body.setAttribute("data-name",`${o} ${n} ${s}`),document.body.setAttribute("data-email",c),p.innerHTML="Actualizar",g(m,20),g(p,20),v(u,30)):f(i,d),Swal.fire({title:y,icon:a,confirmButtonText:"Aceptar",confirmButtonColor:"#000",allowOutsideClick:!1,allowEscapeKey:!1}),t.forEach(e=>e.classList.remove("is-invalid"))}).catch(e=>{console.error(e),p.innerHTML="Actualizar",f(i,d),Swal.fire({title:"Problemas al actualizar datos del usuario",text:"Recargue la p\xe1gina o vuelva a intentarlo",icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000",allowOutsideClick:!1,allowEscapeKey:!1})})}catch(y){console.log(y),p.innerHTML="Actualizar",f(i,d),Swal.fire({title:"Error inesperado",text:y,icon:"error",confirmButtonText:"Aceptar",confirmButtonColor:"#000",allowOutsideClick:!1,allowEscapeKey:!1})}},S=(e,a)=>{let r=new FormData;r.append("method","get_user_auth"),r.append("id",localStorage.getItem("userid")||""),asyncData2("/modules/mod_buycarform/tmpl/model/buyCarForm.php","POST",r).then(r=>{let{status:l,message:i,description:o,data:n}=r;if(!l){Swal.fire({title:i,text:o,icon:"warning",confirmButtonText:"Aceptar",confirmButtonColor:"#000",allowOutsideClick:!1,allowEscapeKey:!1});return}let s="",m="",p="",y="",b="",f="",S="",$="",A=!1;if(0==n.length){let q=e.split(" ");q.length>0&&(s=`${q[0]}`,m="",p="",2==q.length&&(s=`${q[0]}`,m=`${q[1]}`),3==q.length&&(s=`${q[0]}`,m=`${q[1]}`,p=`${q[2]}`),q.length>3&&(s=`${q[0]} ${q[1]}`,m=`${q[2]}`,p=`${q[3]}`))}else s=n.name??"",m=n.surname??"",p=n.secsurname??"",a=n.email??"",y=n.phone??"",b=0==parseInt(n.cPostal)?"":n.cPostal,f=0==parseInt(n.countryId)?"":n.countryId,S=0==parseInt(n.stateId)?"":n.stateId,$="-"==($=n.photo??"")||"--"==$?"":$,A=!0;let L=document.querySelector("#formDataPayment"),_=L.querySelector("#name");""!=s.trim()&&(_.value=s,_.setAttribute("readonly",!0),_.classList.add("btn-disabled"));let I=L.querySelector("#lastname1");""!=m.trim()&&(I.value=m,I.setAttribute("readonly",!0),I.classList.add("btn-disabled"));let E=L.querySelector("#lastname2");""!=p.trim()&&(E.value=p,E.setAttribute("readonly",!0),E.classList.add("btn-disabled"));let x=L.querySelector("#email");""!=a.trim()&&(x.value=a,x.setAttribute("readonly",!0),x.classList.add("btn-disabled"));let C=L.querySelector("#telwhat");""!=y.trim()&&(C.value=y.replaceAll(" ","").replace("+52",""),C.setAttribute("readonly",!0),C.classList.add("btn-disabled"));let w=L.querySelector("#cp");""!=b.trim()&&(w.value=b,w.setAttribute("readonly",!0),w.classList.add("btn-disabled"));let T=L.querySelector("#country");""!=f.trim()&&(T.setAttribute("disabled",!0),T.classList.add("btn-disabled"),setTimeout(()=>{let e=T.querySelectorAll("option");e.forEach(e=>{e.value==f&&(e.setAttribute("selected","selected"),""!=S.trim()&&(state.setAttribute("disabled",!0),state.classList.add("btn-disabled"),t(f,S)))})},500));let M=L.querySelector("#avatar");if(""!=$.trim()&&import("./init_cropper.js").then(e=>{let{deleteImageCropPreview:t}=e;t(M),setTimeout(()=>{M.src=`/images/clientes/fotos/${$}`;let e=document.createElement("img");e.id="tmpAvatarServices",e.classList.add("rounded"),e.src=M.src,e.setAttribute("width",100),e.setAttribute("height",100),M.closest("div").appendChild(e),M.setAttribute("style","display:none;")},200)}).catch(e=>{console.log(e)}),A){let P=document.querySelector("#formTitleContent");P.classList.add("form-titlecontent");let k=document.createElement("div");k.classList.add("btnsEditData");let D=document.createElement("button");D.id="editDataService",D.type="button",D.textContent="Editar",D.classList.add("btn","data-btnedit");let F=document.createElement("button");F.id="cancelDataService",F.type="button",F.textContent="Cancelar",F.setAttribute("style","display:none;"),F.classList.add("btn","data-btncancel");let B=document.createElement("button");B.id="saveDataService",B.type="button",B.textContent="Actualizar",B.setAttribute("style","display:none;"),B.classList.add("btn","data-btnsave"),D.addEventListener("click",()=>{v(F,30),v(B,30),g(D,30),_.removeAttribute("readonly"),_.classList.remove("btn-disabled"),I.removeAttribute("readonly"),I.classList.remove("btn-disabled"),E.removeAttribute("readonly"),E.classList.remove("btn-disabled"),x.removeAttribute("readonly"),x.classList.remove("btn-disabled"),C.removeAttribute("readonly"),C.classList.remove("btn-disabled"),w.removeAttribute("readonly"),w.classList.remove("btn-disabled"),T.removeAttribute("disabled"),T.classList.remove("btn-disabled"),state.removeAttribute("disabled"),state.classList.remove("btn-disabled"),M.removeAttribute("style");let e=L.querySelector("#tmpAvatarServices");e.setAttribute("style","display:none;");let t=L.querySelector(".content_preview_image"),a=t.querySelector("#btnDeleteImg");t.removeAttribute("style"),a.removeAttribute("style")}),F.addEventListener("click",()=>{g(F,20),g(B,20),v(D,30),_.setAttribute("disabled",!0),I.setAttribute("disabled",!0),E.setAttribute("disabled",!0),_.setAttribute("disabled",!0),x.setAttribute("disabled",!0),C.setAttribute("disabled",!0),w.setAttribute("disabled",!0),T.setAttribute("disabled",!0),state.setAttribute("disabled",!0);let e=L.querySelector("#tmpAvatarServices");e.removeAttribute("style"),M.setAttribute("style","display:none;"),M.src=e.src;let t=L.querySelector(".content_preview_image"),a=t.querySelector("#btnDeleteImg");t.setAttribute("style","display:none;"),a.setAttribute("style","display:none;")}),B.addEventListener("click",()=>{let e=0,t=L.querySelectorAll("input");t.forEach(t=>{e+=u(t)});let a=L.querySelectorAll("select");a.forEach(t=>{let a=[{select:"country",messageVacio:"Pais requerido"},{select:"towns",messageVacio:"Municipio requerido"}];a.forEach(a=>{t.id==a.select&&("no_selected"!==t.value.trim()?c(t):(d(t,a.messageVacio),e+=1))})}),0==e&&h(k,t,a)}),k.appendChild(D),k.appendChild(F),k.appendChild(B),P.appendChild(k)}}).catch(e=>{console.error(e),Swal.fire({title:"Problemas al cargar la informaci\xf3n del usuario",text:"Recargue la p\xe1gina o vuelva a inciar sesi\xf3n",icon:"info",confirmButtonText:"Aceptar",confirmButtonColor:"#000",allowOutsideClick:!1,allowEscapeKey:!1})})};document.addEventListener("DOMContentLoaded",()=>{localStorage.getItem("loginRegisUser")&&localStorage.removeItem("loginRegisUser"),r();let e=document.querySelector("#formDataPayment"),a=e.querySelectorAll("input");a.forEach(e=>{e.addEventListener("blur",e=>{let t=e.target;u(t),validateFormFinal()})});let i=e.querySelectorAll("select");i.forEach(e=>{e.addEventListener("blur",e=>{let t=e.target;m(t),validateFormFinal()})});let o=e.querySelector(".inputAttach");o.addEventListener("change",e=>l(o.id));let n=e.querySelector("#addInvoice_yes");n.addEventListener("change",t=>{e.querySelector(".content-attach-file").classList.add("show"),e.querySelector(".content-attach-file").classList.remove("hidden"),validateFormFinal(),null!==document.querySelector(".btnCleanFile")&&document.querySelector(".btnCleanFile").click(),calculate_total()});let s=e.querySelector("#addInvoice_no");s.addEventListener("change",t=>{e.querySelector(".content-attach-file").classList.remove("show"),e.querySelector(".content-attach-file").classList.add("hidden"),validateFormFinal(),calculate_total()});let c=e.querySelector("#country");c.addEventListener("change",e=>{""!==c.value&&t(c.value)});let d=document.querySelector("#checkAviso");d.addEventListener("change",e=>{validateFormFinal()});let y=document.querySelector("#optionsPayment");y.addEventListener("change",e=>{clean_openpay_tdc(),""!==y.value&&"1"==y.value&&document.querySelector("#content_openpay_tdc").removeAttribute("hidden"),calculate_total(),validateFormFinal()});let b=document.querySelector("#telwhat");b.addEventListener("keypress",e=>{p(e)||e.preventDefault()});let v=document.querySelector("img#avatar")||null;null!==v&&v.addEventListener("click",()=>{v.src.includes("data:image")?btnDeleteImg.style.display="block":btnDeleteImg.style.display="none",import(`/modules/mod_buycarform/tmpl/assets/js/init_cropper.js?v=${new Date().getTime()}`).then(e=>{let{initCropperJs:t}=e;t(v)}).catch(e=>{console.log(e)})});let g=document.querySelector("#backArrowForm");g.href=null!==localStorage.getItem("inhost")&&"server"==localStorage.getItem("inhost")?`${window.location.origin}/servicios`:`${window.location.origin}/index.php?option=com_blank&view=blank&Itemid=110`}),window.addEventListener("load",()=>{let e=document.body.getAttribute("data-id")||"",t=document.body.getAttribute("data-name")||"",a=document.body.getAttribute("data-email")||"";if(""==e&&""==t&&""==a){localStorage.getItem("user_profile")&&localStorage.removeItem("user_profile");let r=document.querySelector("#content-canvas");r.innerHTML="",r.setAttribute("style","height: calc(100vh - 340px);"),Swal.fire({title:"Es necesario logearse para continuar",text:"Ser\xe1 redireccionada a la secci\xf3n de servicios",icon:"info",confirmButtonText:"Aceptar",confirmButtonColor:"#000",allowOutsideClick:!1,allowEscapeKey:!1}).then(e=>{if(e.isConfirmed){let t=window.location.origin;location.href=null!==localStorage.getItem("inhost")&&"server"==localStorage.getItem("inhost")?`${t}/servicios`:`${t}/index.php?option=com_blank&view=blank&Itemid=110`}});return}S(t,a),b()})})();